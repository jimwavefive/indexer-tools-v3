###############################################################################
# Indexer Tools v3 — Environment Configuration
#
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Copy the example compose file:
#   cp docker-compose.example.yml docker-compose.yml
#
# Then start the stack:
#   docker compose up --build -d
#
# Variables prefixed with VITE_ are baked into the frontend at build time.
# All others are read at runtime by the frontend entrypoint or backend.
#
# NOTE: indexer-tools-config.json is served publicly by the frontend and
# should not contain sensitive secrets beyond what the frontend already needs.
###############################################################################


# ─── Security ────────────────────────────────────────────────────────────────
# Shared secret that protects the backend API from unauthorized access.
# The frontend proxy automatically forwards this key on all /api/* requests.
# If not set, the backend API is unprotected (backwards-compatible).
# Required in production.
#MIDDLEWARE_API_KEY=""

# CORS origin restriction for the backend. Defaults to '*' (allow all).
# In production behind a reverse proxy, set to your frontend URL.
#MIDDLEWARE_CORS_ORIGIN="https://your-domain.com"


# ─── Graph API ───────────────────────────────────────────────────────────────
# API key for The Graph gateway. The default key is limited to $25/mo.
# VITE_GRAPH_API_KEY is baked into the frontend build as a fallback.
# GRAPH_API_KEY is injected at runtime by the docker entrypoint.
VITE_GRAPH_API_KEY="3bab348a7c385b1870039eb890fd0a5f"
GRAPH_API_KEY="3bab348a7c385b1870039eb890fd0a5f"


# ─── Frontend: Default Accounts ─────────────────────────────────────────────
# JSON array of indexer accounts loaded at startup (runtime, via entrypoint).
#DEFAULT_ACCOUNTS='[{"address":"0x...","name":"my-indexer","active":true,"chain":"arbitrum-one","agentConnect":false,"agentEndpoint":"","poiQuery":false,"poiQueryEndpoint":"","chainValidation":false,"chainValidationEndpoint":""}]'


# ─── Frontend: RPC Endpoints ────────────────────────────────────────────────
# Override default RPC providers (runtime, via entrypoint).
#DEFAULT_RPC_MAINNET="https://mainnet.infura.io/v3/YOUR_KEY"
#DEFAULT_RPC_ARBITRUM="https://arb-mainnet.g.alchemy.com/v2/YOUR_KEY"
#DEFAULT_RPC_SEPOLIA="https://eth-sepolia.g.alchemy.com/v2/YOUR_KEY"
#DEFAULT_RPC_ARBITRUM_SEPOLIA="https://arbitrum-sepolia.infura.io/v3/YOUR_KEY"


# ─── Frontend: Network Subgraphs ────────────────────────────────────────────
# Override default Graph Network subgraph endpoints (runtime, via entrypoint).
# Use [api-key] as placeholder — it gets replaced with GRAPH_API_KEY at runtime.
#DEFAULT_SUBGRAPH_MAINNET="https://gateway.thegraph.com/api/[api-key]/subgraphs/id/9Co7EQe5PgW3ugCUJrJgRv4u9zdEuDJf8NvMWftNsBH8"
#DEFAULT_SUBGRAPH_ARBITRUM="https://gateway.thegraph.com/api/[api-key]/subgraphs/id/DZz4kDTdmzWLWsV373w2bSmoar3umKKH9y82SUKr5qmp"
#DEFAULT_SUBGRAPH_SEPOLIA="https://gateway.thegraph.com/api/[api-key]/subgraphs/id/8pVKDwHniAz87CHEQsiz2wgFXGZXrbMDkrxgauVVfMJC"
#DEFAULT_SUBGRAPH_ARBITRUM_SEPOLIA="https://gateway.thegraph.com/api/[api-key]/subgraphs/id/3xQHhMudr1oh69ut36G2mbzpYmYxwqCeU6wwqyCDCnqV"


# ─── Frontend: Other Subgraphs ──────────────────────────────────────────────
# QoS (Quality of Service) subgraph for query performance data (runtime).
#DEFAULT_QOS_SUBGRAPH="https://gateway.thegraph.com/api/[api-key]/subgraphs/id/Dtr9rETvwokot4BSXaD5tECanXfqfJKcvHuaaEgPDD2D"


# ─── Frontend: Chain Validation ─────────────────────────────────────────────
# JSON object mapping chain IDs to RPC endpoints for on-chain validation (runtime).
# Example: {"1":"https://mainnet.infura.io/v3/KEY","42161":"https://arb.alchemy.com/v2/KEY"}
#CHAIN_VALIDATION_RPCS='{}'


# ─── Feature Flags (build-time) ─────────────────────────────────────────────
# These are baked into the frontend at build time via Vite.
# Set to "true" to enable, "false" to disable.
VITE_FEATURE_NOTIFICATIONS=false
VITE_FEATURE_AGENT=false


# ─── Backend: Notifications ─────────────────────────────────────────────────
# Enable the notification polling service in the backend.
FEATURE_NOTIFICATIONS_ENABLED=false

# Your indexer address (required when notifications are enabled).
#INDEXER_ADDRESS="0x..."

# How often (in seconds) the backend polls for notification triggers.
# Can also be changed at runtime via the Settings UI.
#POLLING_INTERVAL_SECONDS=600

# Cooldown (in minutes) before re-sending a notification for the same incident.
# Can also be changed at runtime via the Settings UI.
#COOLDOWN_MINUTES=60

# Network subgraph URL used by the backend notification poller.
#NETWORK_SUBGRAPH_URL="https://gateway.thegraph.com/api/YOUR_KEY/subgraphs/id/DZz4kDTdmzWLWsV373w2bSmoar3umKKH9y82SUKr5qmp"

# Indexer status endpoint for "Failed Subgraph" and "Behind Chainhead" notification rules.
# By default, the backend resolves this from the indexer's on-chain registered URL + /status.
# Set this to override with a direct upstream (e.g. indexer-service-rs) to bypass TLS/proxy.
#INDEXER_STATUS_ENDPOINT="http://indexer-service:7610/status"

# Notification channels configured via env vars. Uses a numbered pattern
# (like CHAIN_0_*, CHAIN_1_*, etc.). Each channel needs NAME, TYPE, ENABLED,
# and type-specific config (e.g. WEBHOOK_URL for discord).
# Channels are synced to the store at startup — env vars take precedence.
#
#NOTIFICATION_CHANNEL_0_NAME="Discord Alerts"
#NOTIFICATION_CHANNEL_0_TYPE="discord"
#NOTIFICATION_CHANNEL_0_ENABLED=true
#NOTIFICATION_CHANNEL_0_WEBHOOK_URL="https://discord.com/api/webhooks/..."


# ─── Backend: Chain RPC ─────────────────────────────────────────────────────
# Chain RPC endpoints for block queries (used by graphman rewind for block hashes).
# Configure individual chains with numbered CHAIN_RPC_<n>_ID and CHAIN_RPC_<n>_URL pairs:
#CHAIN_RPC_0_ID=1
#CHAIN_RPC_0_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_KEY
#CHAIN_RPC_1_ID=42161
#CHAIN_RPC_1_URL=https://arb-mainnet.g.alchemy.com/v2/YOUR_KEY

# Or use ERPC_BASE_URL as a fallback for all chains (URL pattern: {ERPC_BASE_URL}/{chainId}):
#ERPC_BASE_URL=https://rpc.example.com


# ─── Backend: AI Agent ──────────────────────────────────────────────────────
# Enable the AI agent chat feature in the backend.
FEATURE_AGENT_ENABLED=false

# Which LLM provider to use: claude | openai | ollama
#AI_PROVIDER=claude

# API key for Anthropic Claude (required when AI_PROVIDER=claude).
#ANTHROPIC_API_KEY=""

# API key for OpenAI (required when AI_PROVIDER=openai).
#OPENAI_API_KEY=""

# Base URL for Ollama (required when AI_PROVIDER=ollama).
#OLLAMA_BASE_URL="http://localhost:11434"


# ─── Backend: Agent Execution ───────────────────────────────────────────────
# Agent execution mode: dry_run (log commands without executing) or production.
#AGENT_EXECUTION_MODE=dry_run

# Docker container name for graphman commands.
#GRAPHMAN_CONTAINER_NAME=index-node-mgmt-0
